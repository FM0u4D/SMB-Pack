<svg width="1100" height="440" viewBox="0 0 1100 440" xmlns="http://www.w3.org/2000/svg"
  font-family="Inter, Arial, sans-serif">

  <!-- Background -->
  <rect width="1100" height="440" fill="#0d1117"></rect>

  <!-- Title -->
  <text x="550" y="30" text-anchor="middle" fill="#f0f6fc" font-size="18" font-weight="600">
    SMB Authentication vs Unix Filesystem Authorization
  </text>

  <!-- Subtitle -->
  <text x="550" y="52" text-anchor="middle" fill="#8b949e" font-size="12">
    Authentication success does not guarantee filesystem access
  </text>

  <!-- Section headers -->
  <text x="180" y="90" text-anchor="middle" fill="#8b949e" font-size="12" font-weight="600">
    Authentication Layer
  </text>

  <text x="550" y="90" text-anchor="middle" fill="#8b949e" font-size="12" font-weight="600">
    Filesystem Authorization Layer
  </text>

  <text x="910" y="90" text-anchor="middle" fill="#8b949e" font-size="12" font-weight="600">
    Effective Result
  </text>

  <!-- SMB Authentication -->
  <rect x="60" y="115" width="240" height="115" rx="12" fill="#161b22" stroke="#2ea043"
    stroke-width="2"></rect>
  <text x="180" y="150" text-anchor="middle" fill="#e6edf3" font-size="14" font-weight="600">
    SMB Authentication
  </text>
  <text x="180" y="175" text-anchor="middle" fill="#8b949e" font-size="12">
    Identity validated
  </text>
  <text x="180" y="198" text-anchor="middle" fill="#2ea043" font-size="12">
    ✔ Authentication successful
  </text>

  <!-- Filesystem Authorization -->
  <rect x="420" y="115" width="260" height="150" rx="12" fill="#161b22" stroke="#f85149"
    stroke-width="2"></rect>
  <text x="550" y="150" text-anchor="middle" fill="#e6edf3" font-size="14" font-weight="600">
    Unix Filesystem Authorization
  </text>

  <text x="550" y="178" text-anchor="middle" fill="#8b949e" font-size="12">
    Parent directory traversal
  </text>

  <text x="550" y="200" text-anchor="middle" fill="#8b949e" font-size="12">
    Ownership &amp; mode checks
  </text>

  <text x="550" y="232" text-anchor="middle" fill="#f85149" font-size="12">
    ✖ Traversal blocked
  </text>

  <!-- Result -->
  <rect x="780" y="145" width="260" height="100" rx="12" fill="#161b22" stroke="#ff1f13"
    stroke-width="2"></rect>
  <text x="910" y="180" text-anchor="middle" fill="#ff1f13" font-size="30" font-weight="300">
    ⚠
  </text>
  <text x="910" y="205" text-anchor="middle" fill="#ff1f13" font-size="22">
    Access denied
  </text>

  <!-- Flow arrows -->
  <line x1="300" y1="172" x2="420" y2="172" stroke="#30363d" stroke-width="3"
    marker-end="url(#arrow)"></line>

  <line x1="680" y1="195" x2="780" y2="195" stroke="#30363d" stroke-width="3"
    marker-end="url(#arrow)"></line>

  <!-- Full-width dashed separator (red vs green) -->
  <line x1="40" y1="276" x2="1060" y2="276" stroke="#30363d" stroke-width="2" stroke-dasharray="6 6"></line>

  <!-- Curly brace grouping (must look like "{") -->
  <text x="395" y="395" text-anchor="middle" fill="#30363d" font-size="150" font-weight="400">{</text>

  <!-- Group label (ends at middle of brace) -->
  <text x="360" y="362" text-anchor="end" fill="#2ea043" font-size="18">
    Permission alignment applied
  </text>

  <!-- Remediation: permissions -->
  <rect x="420" y="300" width="260" height="50" rx="10" fill="#0b1f33" stroke="#2ea043"
    stroke-width="2"></rect>
  <text x="550" y="330" text-anchor="middle" fill="#e6edf3" font-size="13">
    chmod 755 /srv/samba/public
  </text>

  <!-- Remediation: ownership -->
  <rect x="420" y="360" width="260" height="50" rx="10" fill="#0b1f33" stroke="#2ea043"
    stroke-width="2"></rect>
  <text x="550" y="385" text-anchor="middle" fill="#e6edf3" font-size="13">
    chown -R adminsmb:adminsmb
  </text>

  <!-- Result restored -->
  <rect x="780" y="315" width="260" height="60" rx="10" fill="#0b1f33" stroke="#2ea043"
    stroke-width="2"></rect>
  <text x="910" y="350" text-anchor="middle" >
    <tspan fill="#2ea043" font-size="22">✔</tspan>
    <tspan fill="#e6edf3" font-size="14"> Access garanted</tspan>
  </text>

  <!-- Arrow marker -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="5" orient="auto">
      <polygon points="0 0, 10 5, 0 10" fill="#30363d"></polygon>
    </marker>
  </defs>

</svg>